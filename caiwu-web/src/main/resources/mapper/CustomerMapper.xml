<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhimeng.caiwuweb.dao.CustomerMapper">
  <resultMap id="BaseResultMap" type="com.zhimeng.caiwuweb.entity.Customer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="cus_id" jdbcType="INTEGER" property="cusId" />
    <result column="cus_name" jdbcType="VARCHAR" property="cusName" />
    <result column="cus_pwd" jdbcType="VARCHAR" property="cusPwd" />
    <result column="cus_region" jdbcType="VARCHAR" property="cusRegion" />
    <result column="cus_authority" jdbcType="INTEGER" property="cusAuthority" />
    <result column="cus_zhanghao" jdbcType="VARCHAR" property="cusZhanghao" />
    <result column="cus_tel" jdbcType="VARCHAR" property="cusTel" />
    <result column="cus_status" jdbcType="INTEGER" property="cusStatus" />
    <result column="cus_first_name" jdbcType="INTEGER" property="cusFirstName" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    cus_id, cus_name, cus_pwd, cus_region, cus_authority, cus_zhanghao, cus_tel,
    cus_status,cus_first_name
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from customer
    where cus_id = #{cusId,jdbcType=INTEGER}
  </select>

  <select id="selectByZhanghao" parameterType="com.zhimeng.caiwuweb.entity.Customer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <include refid="Base_Column_List" />
    from customer
    where cus_zhanghao = #{cusZhanghao,jdbcType=VARCHAR}
  </select>

  <select id="selectByTel" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <include refid="Base_Column_List" />
    from customer
    where cus_tel = #{cusTel,jdbcType=VARCHAR}
  </select>

  <select id="selectByName" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <include refid="Base_Column_List" />
    from customer
    where cus_name = #{cusTel,jdbcType=VARCHAR}
  </select>

  <select  id="selectAll" resultMap="BaseResultMap"  parameterType="java.lang.String">
    select
    <include refid="Base_Column_List" />
    from customer
    <where>
      <if test="param1 != null">
        cus_first_name like "%"#{param1}"%"
      </if>

      <!-- 判断是不是超级管理员,超级管理员需要查询本级及下级 -->
      <choose>
        <when test="param2 != null and param3 != null">
          and cus_region in (
          SELECT
          case
          when t3.cityname is not null then t3.cityname
          when t2.cityname is not null then t2.cityname
          when t1.cityname is not null then t1.cityname
          end as cityname
          FROM (select id,cityname,pid from city where type = 5) t1
          LEFT JOIN (select id,cityname,pid from city where type = 5) t2 ON t1.id = t2.pid
          LEFT JOIN (select id,cityname,pid from city where type = 5) t3 ON t2.id = t3.pid
          WHERE t1.cityname = #{param2,jdbcType=VARCHAR}
          )
        </when>
        <when test="param2 != null">
          AND  cus_region = #{param2,jdbcType=VARCHAR}
        </when>
        <otherwise>
          and 1 = 1
        </otherwise>
      </choose>

     <!-- <if test="param2 != null">
      &lt;!&ndash; 修改为查询本级及下级单位的人员 &ndash;&gt;
      &lt;!&ndash; and  cus_region = #{param2}&ndash;&gt;
        and  cus_region = #{param2}
      </if>-->

    </where>
  </select>

  <select  id="selectBackAll" resultMap="BaseResultMap"  parameterType="java.lang.String">
    select
    <include refid="Base_Column_List" />
    from customer
    <where>
      <if test="_parameter != null">
        cus_name like "%"#{param1}"%"
      </if>
    </where>
  </select>


  <select id="selectAllRegion" parameterType="java.lang.String" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from customer where cus_region=#{cusRegion,jdbcType=VARCHAR}
  </select>

  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from customer
    where cus_id = #{cusId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.zhimeng.caiwuweb.entity.Customer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into customer (cus_id, cus_name, cus_pwd, 
      cus_region, cus_authority,
      cus_zhanghao, cus_tel, cus_status
      )
    values (#{cusId,jdbcType=INTEGER}, #{cusName,jdbcType=VARCHAR}, #{cusPwd,jdbcType=VARCHAR}, 
      #{cusRegion,jdbcType=VARCHAR},#{cusAuthority,jdbcType=INTEGER},
      #{cusZhanghao,jdbcType=VARCHAR}, #{cusTel,jdbcType=VARCHAR}, #{cusStatus,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.zhimeng.caiwuweb.entity.Customer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into customer
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="cusId != null">
        cus_id,
      </if>
      <if test="cusName != null">
        cus_name,
      </if>
      <if test="cusPwd != null">
        cus_pwd,
      </if>
      <if test="cusRegion != null">
        cus_region,
      </if>
      <if test="cusAuthority != null">
        cus_authority,
      </if>
      <if test="cusZhanghao != null">
        cus_zhanghao,
      </if>
      <if test="cusTel != null">
        cus_tel,
      </if>
      <if test="cusStatus != null">
        cus_status,
      </if>
      <if test="cusFirstName != null">
        cus_first_name,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="cusId != null">
        #{cusId,jdbcType=INTEGER},
      </if>
      <if test="cusName != null">
        #{cusName,jdbcType=VARCHAR},
      </if>
      <if test="cusPwd != null">
        #{cusPwd,jdbcType=VARCHAR},
      </if>
      <if test="cusRegion != null">
        #{cusRegion,jdbcType=VARCHAR},
      </if>
      <if test="cusAuthority != null">
        #{cusAuthority,jdbcType=INTEGER},
      </if>
      <if test="cusZhanghao != null">
        #{cusZhanghao,jdbcType=VARCHAR},
      </if>
      <if test="cusTel != null">
        #{cusTel,jdbcType=VARCHAR},
      </if>
      <if test="cusStatus != null">
        #{cusStatus,jdbcType=INTEGER},
      </if>
      <if test="cusFirstName != null">
        #{cusFirstName,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.zhimeng.caiwuweb.entity.Customer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update customer
    <set>
      <if test="cusName != null">
        cus_name = #{cusName,jdbcType=VARCHAR},
      </if>
      <if test="cusPwd != null">
        cus_pwd = #{cusPwd,jdbcType=VARCHAR},
      </if>
      <if test="cusRegion != null">
        cus_region = #{cusRegion,jdbcType=VARCHAR},
      </if>
      <if test="cusAuthority != null">
        cus_authority = #{cusAuthority,jdbcType=INTEGER},
      </if>
      <if test="cusZhanghao != null">
        cus_zhanghao = #{cusZhanghao,jdbcType=VARCHAR},
      </if>
      <if test="cusTel != null">
        cus_tel = #{cusTel,jdbcType=VARCHAR},
      </if>
      <if test="cusStatus != null">
        cus_status = #{cusStatus,jdbcType=INTEGER},
      </if>
      <if test="cusFirstName != null">
        cus_first_name = #{cusFirstName,jdbcType=VARCHAR},
      </if>
    </set>
    where cus_id = #{cusId,jdbcType=INTEGER}
  </update>

  <!--<update id="updateAuthorityByName" parameterType="com.zhimeng.caiwuweb.entity.Customer">-->
    <!--&lt;!&ndash;-->
      <!--WARNING - @mbg.generated-->
      <!--This element is automatically generated by MyBatis Generator, do not modify.-->
    <!--&ndash;&gt;-->
    <!--update customer-->
    <!--set-->
    <!--cus_authority = #{cusAuthority,jdbcType=INTEGER}-->
    <!--where cus_name = #{cusName,jdbcType=VARCHAR}-->
  <!--</update>-->
</mapper>